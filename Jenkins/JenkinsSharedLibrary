#!/usr/bin/env groovy

@Library('shared-library@master') _ //master or whatever branch

pipeline{
	
        tools {
        maven "maven3.6.3"
    }
	agent any
	
         stages{

              stage('maven build'){
                  steps{
                      script{
		    	         build('Install')
                      	  }
               	     }  
                 }	
             stage(S_Sonar_Report){
                 steps{
                        withSonarQubeEnv('SonarQubeSrvr'){
                          script{
                          sonarQube.sonarAnalysis('DemoWebapp','http://18.183.199.171:9000','squ_6dd59553941c600ed9a5898128fec3b395759a68')
                   }
               }
           }
       }
	 stage('S_NexusArtifactUploader'){
            steps{
                script {
                      nexus.nexus(
                      'demo',
                      '',
                      'target/demo-2.0.0-SNAPSHOT.war',
                      'war',
                      'nexus credentials',
                      'com.domain',
                      '18.181.241.2:8081',
                      'nexus3',
                      'http',
                      'demo',
                      '2.0.0-SNAPSHOT')
                }
            }
            stage ('Check logs') {
                    steps {
                        filterLogs ('WARNING', 50)
                    }
                }
		
           }	
	
}
